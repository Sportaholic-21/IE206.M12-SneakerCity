<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../../template/header.ejs'); -%>
  </head>
  <body>
    <div class="d-flex h-100">
      <div class="col-2 pl-0 h-100 w-25 fixed-top">
        <%- include('../../template/sidebar.ejs'); -%>
      </div>
      <div class="col-12 w-100 pr-0">
        <%- include('../../template/navbar.ejs'); -%>
        <div class="col-10 ml-auto p-0">
          <% if (status=="Success") { %>
            <div class="col-5 ml-auto alert alert-success alert-dismissible">
              <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
              <strong>Thành công!</strong> Dữ liệu đã được gửi lên Database.
            </div>
            <% } else if (status=="Fail"){ %>
              <div class="col-5 ml-auto alert alert-danger alert-dismissible">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                <strong>Thất bại!</strong> Không thể gửi dữ liệu lên Database.
              </div>
              <% } %>
        </div>
        <div class="col-10 ml-auto">
          <div class="d-flex justify-content-between">
            <h1 class="text-primary">Products</h1>
            <form>
              <div class="form-inline pt-2">
                <div class="col">
                  <a class="btn btn-primary" href="/admin/add-product">Add</a>
                </div>
                <div class="dropdown">
                  <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Sort By:
                  </a>
                  <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                    <a class="dropdown-item" href="#">ID</a>
                    <a class="dropdown-item" href="#">Price</a>
                    <a class="dropdown-item" href="#">In Stock</a>
                    <a class="dropdown-item" href="#">Sales</a>
                  </div>
                </div>
                <div class="col">
                  <input type="text" class="form-control mr-sm-2" placeholder="Search" />
                </div>
                <button type="submit" class="btn btn-outline-primary my-2 my-sm-0">
                  Search
                </button>
              </div>
            </form>
          </div>

          <table class="table table-hover">
            <thead>
              <tr>
                <th scope="col">Image</th>
                <th scope="col">Name</th>
                <th scope="col">Price</th>
                <th scope="col">Category</th>
                <th scope="col">Quantity In Stock</th>
                <th scope="col">IsNew</th>
                <th scope="col">Sales</th>
                <th scopr="col">Action</th>
              </tr>
            </thead>
            <tbody>
              <% product.forEach(product => { %>

              <tr>
                <td
                  style="width: 150px"
                  data-toggle="modal"
                  data-target="#productImage"
                >
                <img src="<%= product.coverImagePath %>" alt="productImage" class="img-fluid" />
              </td>
                <td
                  data-toggle="modal"
                  class="align-middle"
                  data-target="#productName"
                ><%= product.name %></td>
                <td
                  data-toggle="modal"
                  class="align-middle"
                  data-target="#productPrice"
                >
                <%= product.price %>&dollar;
                </td>
                <td
                  data-toggle="modal"
                  class="align-middle"
                  data-target="#productCategory"
                ><%= product.category[0].name %></td>
                <td
                  class="align-middle text-center d-flex"
                  data-toggle="modal"
                  data-target="#productQuantity"
                ><%= product.quantity %></td>
                <td
                  class="text-danger align-middle"
                  data-toggle="modal"
                  data-target="#productIsNew"
                ><%= product.condition %></td>
                <td
                  data-toggle="modal"
                  class="align-middle"
                  data-target="#productSales"
                >
                  <%= product.sale %> %
                </td>
                <td class="align-middle d-flex">
                  <a href="edit-product" class="btn btn-success">Edit</a>
                  <button type="button" class="btn btn-danger deleteBtn" data-toggle="modal"
                      data-target="#exampleModal" data-id="<%= product.id %>" data-name="<%= product.name %>" data-link="product/">
                      Delete
                    </button>
                </td>
              </tr>
              <% }) %>
            </tbody>
          </table>
          <div
            class="modal fade"
            id="exampleModal"
            tabindex="-1"
            role="dialog"
            aria-labelledby="exampleModalLabel"
            aria-hidden="true"
          >
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">
                    Xác nhận xóa
                  </h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  Chắc chắn xóa Sản phẩm <span id="idTeam"></span>?
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">
                    Close
                  </button>
                  <form method="post" id="deleteBtnHref">
                    <input type="submit" class="btn btn-danger" value="Xóa">
                  </form>
                </div>
              </div>
            </div>

          </div>
        </div>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
    crossorigin="anonymous"></script>
  <script>
    $(document).on("click", ".deleteBtn", function () {
      var id = $(this).data("id");
      // alert(id);
      var link = $(this).data("link");
      $("#exampleModal #deleteBtnHref").attr(
        "href",
        link + "/deletedb/" + id
      );
      $("#exampleModal #idTeam").text(id);
    });
  </script>
</body>
<%- include('../../template/footer.ejs'); -%>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
      crossorigin="anonymous"
    ></script>
    <script>
      $(document).on("click", ".deleteBtn", function () {
        var id = $(this).data("id");
        var name = $(this).data("name");
        // alert(id);
        var link = $(this).data("link");
        $("#exampleModal #deleteBtnHref").attr(
          "action",
          link + "delete/" + id + "?_method=DELETE"
        );
        $("#exampleModal #idTeam").text(name);
      });
    </script>
  </body>
  <%- include('../../template/footer.ejs'); -%>
</html>
